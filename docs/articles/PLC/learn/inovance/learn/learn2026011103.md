## 一、本节课程大纲总结

本次课程系统地讲解了H5U系列PLC的编程基础，核心内容可分为以下六个部分：
1.  **软元件分类与功能**：介绍了X/Y、M、S、B等位软元件和D、R、W等字软元件的地址范围、特性及用途。
2.  **数据类型与存储结构**：阐述了基本数据类型（位、整型、双整型、浮点数）及其在存储器中的组织方式（字、双字、位排列规则）。
3.  **数据存储原理**：解释了数据如何以二进制形式存入PLC，包括低位对齐、高位补零的规则。
4.  **进制转换方法**：讲解了二进制、十进制、十六进制之间相互转换的原理与技巧。
5.  **数值的二进制表示**：深入分析了整数（原码、补码）和浮点数（IEEE 754标准）在计算机内部的表示方法。
6.  **自定义变量应用**：介绍了为提高编程效率而使用的自定义变量，包括其类型、定义方法以及高级应用（数组、结构体、地址绑定）。

---

### 二、根据节点归纳总结

#### 1. H5U里面的软元件分类及详细介绍
H5U软元件可分为**位软元件**和**字软元件**两大类。

| 类别 | 元件类型 | 关键特性与地址范围 | 主要用途 |
| :--- | :--- | :--- | :--- |
| **位软元件** (布尔型) | **X** (输入) | 八进制编码，范围X0-X17777。**注意**：逢8进位（如X7后是X10）。 | 接收外部物理信号 |
| | **Y** (输出) | 八进制编码，范围同X点。 | 驱动外部负载 |
| | **M** (辅助继电器) | M0-M7999。**断电保持特性**：M0-M999断电不保存，M1000-M7999断电保存。M8000后为特殊功能继电器。 | 程序内部逻辑控制 |
| | **S** (状态继电器) | S0-S4095。S0-S699断电不保存，S1000后断电保存。 | 顺序流程控制 |
| | **B** (扩展继电器) | **H5U新增**，B0-B32767。B0-B999断电不保存，B1000后断电保存。可替代M点，点数更多。 | 同M点，提供更多逻辑点 |
| **字软元件** (16位) | **D** (数据寄存器) | D0-D7999。**断电保持特性**：D0-D999断电不保存，D1000后断电保存。 | 存储数据、参数 |
| | **R** (寄存器) | R0-R32767。特性同D区。**H5U特色**，与D区功能基本互通。 | 同D区 |
| | **W** (寄存器) | 逻辑同D区。**H5U特色**。 | 同D区 |
| **特殊软元件** | **SBR** (子程序标签) | SBR0-SBR1023 | 用于CALL指令调用子程序 |
| | **LBL** (跳转标签) | L0-L1023 | 用于CJ指令实现程序跳转 |
| | **I** (中断标签) | 分为外部中断、定时中断、比较中断 | 处理紧急事件 |

#### 2. H5U里面的数据类型与存储结构
- **基本数据类型**：
    - **布尔型 (Bool)**：位状态，0或1。
    - **整数 (INT, 16位)**：范围-32768 ~ +32767。
    - **双整数 (DINT, 32位)**：范围约±21亿，占用2个连续字寄存器。
    - **实数 (REAL, 32位)**：浮点数，占用2个连续字寄存器。
- **存储器结构**：
    - 基本单位是**字 (Word, 16位)**，如D0、R0。
    - **位 (Bit)** 是字的基本组成，一个字包含16个位（例如D0.0 ~ D0.15）。
    - **排列规则**：**左高右低**。位编号从右向左增大（D0.0为最低位，D0.15为最高位）。双字（如D0和D1组成）的位排列延续此规则，最低位为D0.0，最高位为D1.15。

#### 3. 数据存储方式
- 所有数据（整数、浮点数、字符等）最终都以**二进制形式**存储。
- **存储规则**：数值的二进制从**最低位 (LSB)** 开始，对齐存储元件的最低位（如D0.0），未使用的高位自动**补零**。
- **空间占用**：16位数据（如INT）占用1个字；32位数据（如DINT, REAL）占用2个连续的字。
- **关键点**：存储器本身无类型，数据的解释取决于使用的指令。同样的二进制串，用整数指令解读是整数，用浮点数指令解读是浮点数。

#### 4. 进制转化
- **核心原理**：利用不同进制的权值关系（十进制逢十进一，二进制逢二进一，十六进制逢十六进一）。
- **十进制 ↔ 二进制**：
    - **除二取余法**：十进制数不断除以2，记录余数，倒序排列即为二进制。
    - **幂次和法**：找到不超过目标数的最大2的幂次，依次减去，得到二进制各位。
- **二进制 ↔ 十六进制**：采用**四位一组**法。二进制数从低位开始，每4位一组，直接转换为一位十六进制数（0-9, A-F），反之亦然。这是最常用的快速转换方法。
- **实践建议**：理解原理，但实际开发中多用计算器或编程工具转换。

#### 5. 数值的表示
- **整数**：
    - 用**原码**表示。最高位是**符号位**（0正1负），其余位表示数值大小。
    - **负数**在计算机中实际存储的是其**补码**。求法：**原码取反后加1**。
- **浮点数**：
    - 采用**IEEE 754标准**（单精度，32位）。
    - 分为三部分：
        1.  **符号位 (S, 1位)**：0正1负。
        2.  **指数位 (E, 8位)**：实际指数 = **E - 127**（偏移码）。
        3.  **尾数位 (M, 23位)**：存储小数点后的有效数字。

#### 6. 自定义变量
- **目的**：提高程序可读性、可维护性和编程便利性。
- **类型**：支持位、整数、双整数、浮点数、指针、数组、结构体等。
- **定义与使用**：在编程软件的变量表中定义变量（名称、数据类型、初始值、是否断电保持等），然后在程序中直接使用变量名编程。
- **命名规则**：可使用字母、数字、中文、下划线，但不能以数字或下划线开头，且不能与系统关键字（软元件名、指令、数据类型等）重名。

#### 7. 结构体
- **概念**：一种高级数据类型，将**不同类型**的变量（成员）打包成一个整体，便于管理复杂数据。
- **应用**：非常适合管理具有多个属性的对象，如“电机”结构体可包含`启动按钮(Bool)`、`转速(INT)`、`电流(REAL)`等成员。
- **使用**：需先定义结构体类型（包含哪些成员及其数据类型），然后在变量表中声明该结构体类型的变量。访问成员使用**点号(.)**，如`Motor1.Start`。

#### 8. 变量绑定地址（补充自学霸笔记）
- **自动分配**：定义自定义变量时，可指定关联的PLC软元件地址（如将`StartBtn`变量关联到M0）。未指定时系统自动分配。
- **地址连续性**：数组、结构体等复合变量会占用连续的地址空间。例如，一个INT数组从D10开始，则元素依次占用D10, D11, D12...
- **注意事项**：
    - 不同数据类型的变量占用空间不同（DINT/REAL占2个字），地址会相应偏移。
    - 需警惕**地址冲突**，即不同变量被意外分配到同一地址区域，导致数据覆盖。重要变量建议手动分配地址。