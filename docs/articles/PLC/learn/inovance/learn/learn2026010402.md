## **今日课程知识点大纲**

1.  **中间继电器（M）的核心概念**
    *   功能与特点
    *   别称与形象比喻
    *   与输出继电器（Y）的根本区别

2.  **中间继电器的分类、范围及特点**
    *   一般用内部继电器
    *   停电保持用内部继电器
    *   特殊继电器

3.  **特殊继电器的详解与实际应用**
    *   运行状态监控型（M8000, M8001, M8002, M8003）
    *   脉冲/震荡型（M8011, M8012, M8013, M8014）

4.  **关键操作与注意事项**
    *   复位指令的应用
    *   PLC扫描周期对高速脉冲继电器的影响
    *   停电保持功能的硬件依赖（电池）

5.  **与其他PLC品牌的对比**

---

## **一、中间继电器M的功能及特点，别称**

*   **功能**：中间继电器（M）是PLC内部的虚拟继电器，主要用于程序内部的逻辑运算、信号传递和中间状态暂存。它相当于控制系统的“逻辑枢纽”，可以无限次使用其常开/常闭触点来构建复杂的控制逻辑。
*   **核心特点**：
    1.  **虚拟元件**：仅存在于PLC程序内部，不直接连接外部物理设备。
    2.  **触点无限使用**：同一个M继电器的触点可以在程序中被多次引用。
    3.  **不能直接驱动负载**：M点本身不能直接驱动接触器、指示灯等外部负载，必须通过输出继电器（Y）来执行。
    4.  **可被触摸屏监控与控制**：可以通过上位机（如触摸屏）来强制或监控M点的状态，从而干预程序运行。
*   **别称与比喻**：
    *   **别称**：内部继电器。
    *   **学霸同学比喻**：
        *   M是PLC的“**大脑内部开关**”，负责思考与逻辑判断。
        *   Y是PLC的“**手脚**”，负责具体动作的执行。
        *   停电保持功能就像电脑的“**休眠**”模式，而普通继电器则像“**关机**”后一切重置。

## **二、中间继电器分类及其范围、特点**

| 分类 | 范围（汇川PLC） | 特点 |
| :--- | :--- | :--- |
| **一般用内部继电器** | M0 ~ M999 | PLC断电或停止运行后，其状态**自动复位**为OFF（失电）。用于不需要保持状态的临时逻辑控制。 |
| **停电保持用内部继电器** | M1000 ~ M7999 | 具备**断电保持功能**。断电后，其状态会被保存在PLC的永久存储区（依靠内部电池），重新上电后能恢复到断电前的状态。常用于记录设备模式、加工数量等需要保持的数据。 |
| **特殊继电器** | M8000 开始 | 每个继电器都有PLC系统分配的**特定功能**，用户不能自定义其线圈逻辑。用于监控PLC运行状态、提供时钟脉冲等。 |

**注意**：M点的编号为**十进制**，而输入/输出点（X/Y）为**八进制**（例如：X7之后是X10，没有X8, X9）。

## **三、本节特殊继电器（实际中的应用）**

| 特殊继电器 | 功能描述 | 实际应用场景 |
| :--- | :--- | :--- |
| **M8000** | **RUN监控**：只要PLC处于运行（RUN）状态，此触点就**一直为ON**。 | 1. **监控指示**：驱动一个指示灯（Y点），直观显示PLC是否在运行。<br>2. **程序段合并**：作为多个需要持续运行的程序段的公共条件，简化程序结构。类似于西门子S7-200 SMART中的`SM0.0`。 |
| **M8001** | 与M8000**逻辑相反**，PLC运行时为OFF。 | 用于需要在PLC停止时才生效的逻辑。 |
| **M8002** | **初始脉冲**：在PLC从STOP转为RUN的**第一个扫描周期**内产生一个ON脉冲，之后维持OFF。 | **程序初始化**：用于复位计数器、数据寄存器，或设置设备的初始参数。例如：开机时清除产量计数、将机械手回归原点。 |
| **M8003** | 与M8002**逻辑相反**，在第一个扫描周期为OFF，之后为ON。 | 可用于排除初始化周期的干扰。 |
| **M8011** | **10ms时钟脉冲**：周期10ms（ON 5ms, OFF 5ms）。 | 提供高速时钟信号。**注意**：由于PLC扫描周期可能较长（如H5U约10ms），此脉冲在实际中可能观察不到稳定闪烁。 |
| **M8012** | **100ms时钟脉冲**：周期100ms（ON 50ms, OFF 50ms）。 | 可用于需要快速闪烁的指示灯，或作为短时间定时的基准。 |
| **M8013** | **1s时钟脉冲**：周期1秒（ON 0.5s, OFF 0.5s）。 | **最常用**的时钟脉冲。用于指示灯闪烁、设备周期性巡检信号等。 |
| **M8014** | **1min时钟脉冲**：周期60秒（ON 30s, OFF 30s）。 | 用于长时间、低频率的周期性控制，如设备定时切换模式。 |

## **四、统计出对照其他PLC的表格**

| 功能描述 | 汇川 PLC | 西门子 S7-200 SMART | 三菱 FX 系列 | 欧姆龙 CP系列 |
| :--- | :--- | :--- | :--- | :--- |
| **始终接通** | M8000 | SM0.0 | M8000 | CF113(常通标志) |
| **初始脉冲（首个扫描周期）** | M8002 | SM0.1 | M8002 | CF114(首次循环标志) |
| **1秒时钟脉冲** | M8013 | SM0.5 | M8013 | CF102(1秒时钟脉冲) |
| **RUN监控** | M8000 | SM0.0 | M8000 | A200.11（运行标志） |

更多主流PLC型号的特殊继电器功能对照表。

## **特殊继电器功能对照表（扩展）**

| 功能描述 | 汇川 PLC | 三菱 FX 系列 | 西门子 S7-200 SMART | 西门子 S7-1200/1500 (TIA Portal) | 欧姆龙 CP1 / CJ2系列 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **始终接通（常ON）** | **M8000** | **M8000** | **SM0.0** | **“始终导通”位**<br>(常通，无地址) | **CF113** (常通标志) 或 **P_On** |
| **初始脉冲（首个扫描周期ON）** | **M8002** | **M8002** | **SM0.1** | **FirstScan** 系统位<br>(位于“系统常数”区域) | **CF114** (首次循环标志) 或 **P_FirstCycle** |
| **1秒时钟脉冲** | **M8013** | **M8013** | **SM0.5** | 需使用**时钟存储器**功能或**周期时钟**指令<br>(例如，设置MB0的Bit5为1Hz) | **CF102** (1秒时钟脉冲) 或 **P_1s** |
| **RUN监控** | **M8000** | **M8000** | **SM0.0** | **“始终导通”位** 或 <br>**DB块中的PLC设备诊断数据** | **A200.11** (运行标志) |

---

### **各品牌详细说明与注意事项**

1.  **西门子 S7-1200/1500 (TIA Portal)**
    *   与S7-200 SMART使用**特殊存储器（SM）** 的概念不同，S7-1200/1500更倾向于使用**系统常数**和**程序指令**来实现类似功能。
    *   **常通/初始脉冲**：在OB1中，可以直接拖拽“系统常数”中的 **FirstScan**（初始脉冲）和 **AlwaysTRUE**（常通）到程序中，它们是没有实际地址的符号变量。
    *   **时钟脉冲**：最常用的方法是配置**时钟存储器**。
        *   **步骤**：在“设备配置”中，选中CPU属性，找到“系统和时钟存储器”选项，勾选“启用时钟存储器字节”（例如设置为MB0）。系统会自动将该字节的各个位定义为不同频率的脉冲（如M0.5为1Hz，M0.4为2Hz等）。
    *   **应用示例（SCL语言）**：
        ```scl
        // 使用初始脉冲进行初始化
        IF #FirstScan THEN
            #StartValue := 0;
        END_IF;

        // 使用时钟存储器位实现闪烁
        IF "Clock_1Hz" THEN // "Clock_1Hz" 是分配给MB0某个位的符号名
            #Indicator := NOT #Indicator;
        END_IF;
        ```

2.  **欧姆龙 CP1 / CJ2系列 (Sysmac Studio)**
    *   欧姆龙使用**条件标志（CF）** 和**辅助继电器（A）** 来实现特殊功能。
    *   **P_On, P_FirstCycle** 等是Sysmac Studio中预定义的**全局符号**，与地址CF113, CF114等对应。使用符号（如P_On）比直接使用地址（CF113）更直观，是推荐的做法。
    *   **A区继电器**：部分特殊状态存储在A区，如运行标志`A200.11`。

3.  **三菱 FX 系列 (GX Works2)**
    *   汇川PLC的特殊继电器定义与三菱FX系列**高度兼容**，例如M8000, M8002, M8013等地址和功能完全一致。这使得从三菱转换到汇川的编程门槛非常低。

### **核心要点总结**

*   **共通性**：所有品牌的PLC都提供了这些基础的系统功能，但实现方式和寻址地址不同。
*   **趋势**：现代PLC（如西门子S7-1200/1500，欧姆龙NJ/NX系列）更倾向于使用**符号化编程**和**指令/功能块**来替代传统的固定地址特殊继电器，这使得程序更易读、更灵活。
*   **兼容性**：汇川和三菱在特殊继电器地址上保持了高度一致，降低了学习成本。

### **五、补充知识点（根据笔记内容添加）**

*   **复位指令（ZRST/RST）**：用于将一批或一个中间继电器（包括保持型M）的状态清除（置OFF）。常用于程序初始化，或在设备故障排除后清除异常状态。
*   **扫描周期的影响**：对于高速脉冲继电器（如M8011），PLC的扫描周期（处理程序一遍所需时间）会影响其实际效果。如果扫描周期接近或大于脉冲周期，则无法观察到稳定的脉冲输出。在模拟器中可能看到效果，但在实际硬件上需谨慎使用。
*   **停电保持的硬件基础**：停电保持功能依赖于PLC内部的超级电容或电池。如果电池耗尽，保持型继电器的状态也可能丢失。